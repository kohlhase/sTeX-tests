GAUX = localpaths.tex
TEX = $(filter-out $(GAUX) $(AUX), $(shell ls *.tex))
PDF = $(TEX:%.tex=%.pdf)
SMS = $(TEX:%.tex=%.sms)
PDFLATEX = pdflatex -interaction nonstopmode -file-line-error

pdf: sms $(PDF)
sms: $(SMS)
all: pdf

$(PDF): %.pdf: %.tex $< sms pre
	$(PDFLATEX) $< 

$(SMS): %.sms: %.tex $<
	sms $<

# We generate a file localpath.tex which is needed for the tests.
PWD = $(shell pwd)
MATHHUB = $(PWD:%/$(REPOS)=%)

localpaths.tex:
	@echo "\defpath{MathHub}{$(MATHHUB)}\n\mhcurrentrepos{$(REPOS)}" > localpaths.tex

echo:
	@echo $(PDF)
